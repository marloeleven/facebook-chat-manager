(this["webpackJsonpfb-chat-manager"]=this["webpackJsonpfb-chat-manager"]||[]).push([[0],{122:function(e,t,n){e.exports=n(159)},158:function(e,t,n){},159:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(9),o=n.n(r),i=n(18),u=n(85),s=n(46),l=n(24),p=n(60),f=n(21),b=n(55),d=n(103),m=n(210),j=n(208),v=n(17),O=n(110),g=n(194),E=n(105),k=n(72),h=n(193),I=n(68),y=n(192),x=n(211),w=n(196),C=n(57),S=n.n(C),L=n(61),A=n.n(L),T=n(87),V={fb:{appId:"563571747166109",version:"v7.0",messenger:{page_id:"402815903188264",color:"#e68585"},BASE_URL:"https://graph.facebook.com"}},_=n(79),F=n.n(_),P=function(e){return{baseURL:[V.fb.BASE_URL,V.fb.version].join("/"),params:new URLSearchParams(e).toString()}},B=function(e,t){var n=P({access_token:t}),a=n.baseURL,c=n.params;return new Promise(function(){var t=Object(T.a)(A.a.mark((function t(n,r){var o,i,u;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=F.a.get("pages"),S()(o)||!o||o.id!==e){t.next=4;break}return n(o.list),t.abrupt("return");case 4:return t.next=6,fetch("".concat(a,"/me/accounts?fields=id,name,access_token&").concat(c)).then((function(e){return e.json()})).catch(r);case 6:i=t.sent,u=i.data,F.a.set("pages",u),n(u);case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},N=function(e,t){var n=P({access_token:t}),a=n.baseURL,c=n.params;return new Promise(function(){var t=Object(T.a)(A.a.mark((function t(n,r){var o,i,u;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=F.a.get("videos"),S()(o)||!o||o.id!==e){t.next=4;break}return n(o.list),t.abrupt("return");case 4:return t.next=6,fetch("".concat(a,"/").concat(e,"/live_videos?status=id,name,status&").concat(c,"&filtering=[{ field: 'status', operator: 'EQUAL', value: 'LIVE' }]&limit=10")).then((function(e){return e.json()})).catch(r);case 6:i=t.sent,u=i.data,n(u);case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},Z=Object(p.b)({name:"app",initialState:{loggedIn:!1,accessToken:"",userId:"",pages:[],pageId:"",pageAccessToken:"",liveVideos:[],liveVideoId:""},reducers:{setLoginState:function(e,t){var n=t.payload,a=n.accessToken,c=n.userId,r=Boolean(a&&c);Object.assign(e,{accessToken:a,userId:c,loggedIn:r})},setPages:function(e,t){var n=t.payload;e.pages=[(e.accessToken,{id:"me",name:"Default Timeline",access_token:"EAAIP03TKZBtEBAF1xmOaEoeoF6gQ2bNYsVOrZCjFoYcf0S2ZAKNVW3p3ZBsD5ZCjUZCpAmwV7FqfZC0yeAUzE4ftM9x2qON5oZCAr4ptGyvfWHn0zohnEPZBBSXsMmIO6bf6I0SDxpZCRbzIFHmN0Lfd0N1HpfUZAEuwsPypnRW9NEvC9cZAgBTsVlPJoSnX1MJHjXUZD"})].concat(Object(s.a)(n))},setPageId:function(e,t){var n=t.payload,a=e.pages.find((function(e){return e.id===n}));a&&(e.pageId=n,e.pageAccessToken=a.access_token)},setLiveVideos:function(e,t){var n=t.payload;e.liveVideos=n},setLiveVideoId:function(e,t){var n=t.payload;e.liveVideoId=n}}}),U=Z.actions,R=U.setLoginState,D=U.setPages,J=U.setPageId,M=U.setLiveVideos,H=U.setLiveVideoId,W=function(e){return e.app.pages},z=function(e){return e.app.liveVideos},X=Z.reducer,q=n(78),K=n(191),Q=n(195),Y=n(209),G=["id","attachment","created_time","from","message","message_tags"],$=new q.a,ee=new q.a,te=new K.a(!1),ne=$.pipe(Object(I.a)((function(e){return e})),Object(y.a)((function(e,t){return e.id===t.id})));ee.pipe(Object(I.a)((function(e){return e})),Object(h.a)((function(e){var t=e.liveVideoId,n=e.accessToken;return Object(g.a)((function(){return new Promise((function(e,a){var c=function(e,t){var n=G.join(","),a=["https://streaming-graph.facebook.com",e,"live_comments"].join("/"),c=["access_token=".concat(t),"comment_rate=".concat("one_hundred_per_second"),"fields=".concat(n)].join("&");return"".concat(a,"?").concat(c)}(t,n),r=new EventSource(c);r.onopen=function(){e(r),te.next(!0)},r.onerror=function(){a()}}))})).pipe(Object(Q.a)((function(e){return e.pipe(Object(Y.a)(3e3))})),Object(I.a)((function(e){return e})))}))).subscribe((function(e){e.addEventListener("message",(function(e){var t=e.data,n=JSON.parse(t);$.next(n)}))}));var ae,ce=Object(m.a)((function(e,t){return e.pipe(Object(O.a)(R),Object(h.a)((function(){return Object(g.a)((function(){var e=t.value.app,n=e.loggedIn,a=e.userId,c=e.accessToken;return n?B(a,c):[]})).pipe(Object(h.a)((function(e){return e.length?Object(E.a)(D(e)):Object(k.a)()})))})))}),(function(e,t){return e.pipe(Object(O.a)(D),Object(h.a)((function(){return Object(E.a)(Object(v.d)("/pages"))})))}),(function(e,t){return e.pipe(Object(O.a)(J),Object(h.a)((function(){return Object(g.a)((function(){var e=t.value.app,n=e.pageId,a=e.pageAccessToken;return S()(n)?[]:N(n,a)})).pipe(Object(h.a)((function(e){return Object(E.a)(M(e))})))})))}),(function(e,t){return e.pipe(Object(O.a)(M),Object(h.a)((function(){return Object(E.a)(Object(v.d)("/videos"))})))}),(function(e,t){return e.pipe(Object(O.a)(H),Object(h.a)((function(){return Object(E.a)(Object(v.d)("/messages"))})))}),(function(e,t){return t.pipe(Object(I.a)((function(e){var t=e.app,n=t.liveVideoId,a=t.pageAccessToken;return JSON.stringify({liveVideoId:n,accessToken:a})})),Object(y.a)(),Object(x.a)((function(){var e=t.value.app,n=e.liveVideoId,a=e.pageAccessToken;n&&a&&ee.next({liveVideoId:n,accessToken:a})})),Object(w.a)())})),re=Object(m.a)(ce),oe=Object(f.a)(),ie=(ae=oe,Object(l.c)({router:Object(b.b)(ae),app:X})),ue=Object(j.a)(),se=Object(p.a)({middleware:[].concat(Object(s.a)(Object(p.c)()),[ue,Object(d.a)(oe)]),reducer:ie});ue.run(re);var le=n(107),pe=n(108),fe=n(109),be=n(111),de=function(e){Object(be.a)(n,e);var t=Object(fe.a)(n);function n(){var e;Object(le.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={hasError:!1},e}return Object(pe.a)(n,[{key:"componentDidCatch",value:function(e,t){}},{key:"render",value:function(){return this.state.hasError?c.a.createElement("h1",null,"Something went wrong."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return console.log(e),{hasError:!0}}}]),n}(a.Component),me=n(197),je=n(81),ve=function(){return c.a.createElement("div",{className:"absolute top-0 h-full w-full flex justify-center items-center bg-black bg-opacity-50 flex-col"},c.a.createElement(me.a,null),c.a.createElement(je.a,{variant:"button",color:"inherit",className:"pt-4"},"Loading..."))},Oe=n(12),ge=function(e){return Object(a.useEffect)(e,[])},Ee=n(201),ke=window,he=function(e){var t=e.id,n=e.name,a=e.onClick;return c.a.createElement("li",null,c.a.createElement(Ee.a,{onClick:function(){return a(t)}},n))},Ie=function(e){var t=e.id,n=e.title,a=e.status,r=e.onClick;return c.a.createElement("li",null,c.a.createElement(Ee.a,{onClick:function(){return r(t)}},a," :: ",n))},ye=n(80),xe=n(202),we=n(207),Ce=n(206),Se=n(203),Le=n(205),Ae=n(204),Te=Object(xe.a)((function(e){return{root:{display:"block",width:"100%",maxWidth:"36ch",backgroundColor:e.palette.background.paper},inline:{display:"inline"}}})),Ve=function(e){e.id;var t=e.from,n=e.message;e.created_time;return c.a.createElement(c.a.Fragment,null,c.a.createElement(Se.a,{alignItems:"flex-start"},c.a.createElement(Ae.a,{primary:t.name,secondary:c.a.createElement(c.a.Fragment,null,c.a.createElement(je.a,{component:"span",variant:"subtitle2",className:"inline",color:"textPrimary"},n))})),c.a.createElement(Le.a,{component:"li"}))},_e=[{path:"/messages",component:function(){var e=Object(a.useState)(!1),t=Object(ye.a)(e,2),n=(t[0],t[1]),r=Object(a.useState)([]),o=Object(ye.a)(r,2),i=o[0],u=o[1],l=Object(a.useState)(""),p=Object(ye.a)(l,2),f=p[0],b=p[1],d=Te(),m=Object(a.useCallback)((function(e){b(e.target.value)}),[]);return ge((function(){ne.subscribe((function(e){u((function(t){return[].concat(Object(s.a)(t.slice(-200)),[e])}))})),te.subscribe((function(e){return n(e)}))})),c.a.createElement(c.a.Fragment,null,c.a.createElement(we.a,{label:"Filter Message",variant:"outlined",value:f,onChange:m}),c.a.createElement(Ce.a,{className:d.root},i.map((function(e){return f.length&&!e.message.includes(f)?"":c.a.createElement(Ve,Object.assign({key:e.id},e))}))))}},{path:"/videos",component:function(){var e=Object(i.d)(),t=Object(i.e)(z),n=Object(a.useCallback)((function(t){return e(H(t))}),[e]);return c.a.createElement("ul",null,t.map((function(e){return c.a.createElement(Ie,Object.assign({key:e.id},e,{onClick:n}))})))}},{path:"/pages",component:function(){var e=Object(i.d)(),t=Object(i.e)(W),n=Object(a.useCallback)((function(t){return e(J(t))}),[e]);return c.a.createElement("ul",null,t.map((function(e){return c.a.createElement(he,Object.assign({key:e.id},e,{onClick:n}))})))}},{exact:!0,path:"/",component:function(e){var t=Object(i.d)(),n=Object(a.useCallback)((function(e){var n=e.authResponse;if("connected"===e.status){var a=n.accessToken,c=n.userID;t(R({accessToken:a,userId:c}))}}),[t]),r=Object(a.useCallback)((function(){ke.FB.login(n)}),[n]);return ge((function(){ke.FB.init({appId:V.fb.appId,autoLogAppEvents:!0,xfbml:!0,version:V.fb.version}),ke.FB.getLoginStatus(n)})),c.a.createElement(Ee.a,{variant:"contained",color:"primary",onClick:r},"Login to Facebook")}}],Fe=function(){return c.a.createElement(c.a.Fragment,null,_e.map((function(e){return c.a.createElement(Oe.a,Object.assign({key:e.path},e))})))},Pe=Object(xe.a)((function(e){return{root:{display:"flex",flexDirection:"column",padding:"5px",paddingTop:"10px"}}})),Be=c.a.createContext({}),Ne=function(){var e=Pe();return c.a.createElement("div",{className:e.root},c.a.createElement(Be.Provider,{value:{}},c.a.createElement(Fe,null)))};n(158);o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(de,null,c.a.createElement(u.a,null,c.a.createElement(i.a,{store:se},c.a.createElement(b.a,{history:oe},c.a.createElement(a.Suspense,{fallback:c.a.createElement(ve,null)},c.a.createElement(Ne,null))))))),document.getElementById("root"))}},[[122,1,2]]]);
//# sourceMappingURL=main.51dad08f.chunk.js.map