(this["webpackJsonpfb-chat-manager"]=this["webpackJsonpfb-chat-manager"]||[]).push([[0],{122:function(e,t,n){e.exports=n(159)},158:function(e,t,n){},159:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(9),o=n.n(r),i=n(18),s=n(85),u=n(41),l=n(24),m=n(60),f=n(21),p=n(55),d=n(103),b=n(212),g=n(211),j=n(17),v=n(110),O=n(196),k=n(105),E=n(73),h=n(195),y=n(69),x=n(194),I=n(215),C=n(198),_=n(57),w=n.n(_),T=n(61),S=n.n(T),L=n(87),N={fb:{appId:"563571747166109",version:"v7.0",messenger:{page_id:"402815903188264",color:"#e68585"},BASE_URL:"https://graph.facebook.com"}},V=n(80),A=n.n(V),P=function(e){return{baseURL:[N.fb.BASE_URL,N.fb.version].join("/"),params:new URLSearchParams(e).toString()}},F=function(e,t){var n=P({access_token:t}),a=n.baseURL,c=n.params;return new Promise(function(){var t=Object(L.a)(S.a.mark((function t(n,r){var o,i,s;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=A.a.get("pages"),w()(o)||!o||o.id!==e){t.next=4;break}return n(o.list),t.abrupt("return");case 4:return t.next=6,fetch("".concat(a,"/me/accounts?fields=id,name,access_token&").concat(c)).then((function(e){return e.json()})).catch(r);case 6:i=t.sent,s=i.data,A.a.set("pages",s),n(s);case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},B=function(e,t){var n=P({access_token:t}),a=n.baseURL,c=n.params;return new Promise(function(){var t=Object(L.a)(S.a.mark((function t(n,r){var o,i,s,u;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=A.a.get("videos"),w()(o)||!o||o.id!==e){t.next=4;break}return n(o.list),t.abrupt("return");case 4:return t.next=6,fetch("".concat(a,"/").concat(e,"/live_videos?status=id,name,status&").concat(c,"&filtering=[{ field: 'status', operator: 'EQUAL', value: 'LIVE' }]&limit=10")).then((function(e){return e.json()})).catch(r);case 6:i=t.sent,s=i.data,u=s.filter((function(e){return"LIVE"===e.status})),n(u);case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},Z=Object(m.b)({name:"app",initialState:{loggedIn:!1,accessToken:"",userId:"",pages:[],pageId:"",pageAccessToken:"",liveVideos:[],liveVideoId:""},reducers:{setLoginState:function(e,t){var n=t.payload,a=n.accessToken,c=n.userId,r=Boolean(a&&c);Object.assign(e,{accessToken:a,userId:c,loggedIn:r})},setPages:function(e,t){var n=t.payload;e.pages=[(e.accessToken,{id:"me",name:"Default Timeline",access_token:"EAAIP03TKZBtEBAF1xmOaEoeoF6gQ2bNYsVOrZCjFoYcf0S2ZAKNVW3p3ZBsD5ZCjUZCpAmwV7FqfZC0yeAUzE4ftM9x2qON5oZCAr4ptGyvfWHn0zohnEPZBBSXsMmIO6bf6I0SDxpZCRbzIFHmN0Lfd0N1HpfUZAEuwsPypnRW9NEvC9cZAgBTsVlPJoSnX1MJHjXUZD"})].concat(Object(u.a)(n))},setPageId:function(e,t){var n=t.payload,a=e.pages.find((function(e){return e.id===n}));a&&(e.pageId=n,e.pageAccessToken=a.access_token)},setLiveVideos:function(e,t){var n=t.payload;e.liveVideos=n},setLiveVideoId:function(e,t){var n=t.payload;e.liveVideoId=n}}}),M=Z.actions,U=M.setLoginState,R=M.setPages,D=M.setPageId,J=M.setLiveVideos,Q=M.setLiveVideoId,H=function(e){return e.app.pages},W=function(e){return e.app.liveVideos},z=Z.reducer,X=n(79),q=n(193),K=n(197),Y=n(213),G=["id","attachment","created_time","from","message","message_tags"],$=new X.a,ee=new X.a,te=new q.a(!1),ne=$.pipe(Object(y.a)((function(e){return e})),Object(x.a)((function(e,t){return e.id===t.id})));ee.pipe(Object(y.a)((function(e){return e})),Object(h.a)((function(e){var t=e.liveVideoId,n=e.accessToken;return Object(O.a)((function(){return new Promise((function(e,a){var c=function(e,t){var n=G.join(","),a=["https://streaming-graph.facebook.com",e,"live_comments"].join("/"),c=["access_token=".concat(t),"comment_rate=".concat("one_hundred_per_second"),"fields=".concat(n)].join("&");return"".concat(a,"?").concat(c)}(t,n),r=new EventSource(c);r.onopen=function(){e(r),te.next(!0)},r.onerror=function(){a()}}))})).pipe(Object(K.a)((function(e){return e.pipe(Object(Y.a)(3e3))})),Object(y.a)((function(e){return e})))}))).subscribe((function(e){e.addEventListener("message",(function(e){var t=e.data,n=JSON.parse(t);n.from&&n.from.id&&n.from.name&&$.next(n)}))}));var ae,ce=Object(b.a)((function(e,t){return e.pipe(Object(v.a)(U),Object(h.a)((function(){return Object(O.a)((function(){var e=t.value.app,n=e.loggedIn,a=e.userId,c=e.accessToken;return n?F(a,c):[]})).pipe(Object(h.a)((function(e){return e.length?Object(k.a)(R(e)):Object(E.a)()})))})))}),(function(e,t){return e.pipe(Object(v.a)(R),Object(h.a)((function(){return Object(k.a)(Object(j.d)("/pages"))})))}),(function(e,t){return e.pipe(Object(v.a)(D),Object(h.a)((function(){return Object(O.a)((function(){var e=t.value.app,n=e.pageId,a=e.pageAccessToken;return w()(n)?[]:B(n,a)})).pipe(Object(h.a)((function(e){return Object(k.a)(J(e))})))})))}),(function(e,t){return e.pipe(Object(v.a)(J),Object(h.a)((function(){return Object(k.a)(Object(j.d)("/videos"))})))}),(function(e,t){return e.pipe(Object(v.a)(Q),Object(h.a)((function(){return Object(k.a)(Object(j.d)("/messages"))})))}),(function(e,t){return t.pipe(Object(y.a)((function(e){var t=e.app,n=t.liveVideoId,a=t.pageAccessToken;return JSON.stringify({liveVideoId:n,accessToken:a})})),Object(x.a)(),Object(I.a)((function(){var e=t.value.app,n=e.liveVideoId,a=e.pageAccessToken;n&&a&&ee.next({liveVideoId:n,accessToken:a})})),Object(C.a)())})),re=Object(b.a)(ce),oe=Object(f.a)(),ie=(ae=oe,Object(l.c)({router:Object(p.b)(ae),app:z})),se=Object(g.a)(),ue=Object(m.a)({middleware:[].concat(Object(u.a)(Object(m.c)()),[se,Object(d.a)(oe)]),reducer:ie});se.run(re);var le=n(107),me=n(108),fe=n(109),pe=n(111),de=function(e){Object(pe.a)(n,e);var t=Object(fe.a)(n);function n(){var e;Object(le.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={hasError:!1},e}return Object(me.a)(n,[{key:"componentDidCatch",value:function(e,t){}},{key:"render",value:function(){return this.state.hasError?c.a.createElement("h1",null,"Something went wrong."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return console.log(e),{hasError:!0}}}]),n}(a.Component),be=n(199),ge=n(81),je=function(){return c.a.createElement("div",{className:"absolute top-0 h-full w-full flex justify-center items-center bg-black bg-opacity-50 flex-col"},c.a.createElement(be.a,null),c.a.createElement(ge.a,{variant:"button",color:"inherit",className:"pt-4"},"Loading..."))},ve=n(12),Oe=function(e){return Object(a.useEffect)(e,[])},ke=n(203),Ee=window,he=function(e){var t=e.id,n=e.name,a=e.onClick;return c.a.createElement("li",null,c.a.createElement(ke.a,{onClick:function(){return a(t)}},n))},ye=function(e){var t=e.id,n=e.title,a=e.status,r=e.onClick;return c.a.createElement("li",null,c.a.createElement(ke.a,{onClick:function(){return r(t)}},a," :: ",n))},xe=n(62),Ie=n(204),Ce=n(210),_e=n(208),we=n(205),Te=n(207),Se=n(206),Le=n(209),Ne=[{id:"230196471706202_230231665036016",created_time:"2020-08-29T21:51:10+0000",from:{name:'My Test Page with "Quotes"',id:"181666956116565"},message:"testing"},{id:"230196471706202_230231751702674",created_time:"2020-08-29T21:51:17+0000",from:{name:'My Test Page with "Quotes"',id:"181666956116565"},message:"mine #11"},{id:"230196471706202_230231845035998",created_time:"2020-08-29T21:51:28+0000",from:{name:'My Test Page with "Quotes"',id:"181666956116565"},message:"akin na lang po #33 at #44"},{id:"230196471706202_230231845035933",created_time:"2020-08-29T21:51:28+0000",from:{name:"Marlo Dela Torre",id:"181666956116565"},message:"akin na lang po #33 at #44"},{id:"230196471706202_230231845035922",created_time:"2020-08-29T21:51:28+0000",from:{name:'My Test Page with "Quotes"',id:"181666956116565"},message:"akin na lang po #33 at #44"},{id:"230196471706202_230231845035911",created_time:"2020-08-29T21:51:28+0000",from:{name:"Onchong Revilla",id:"181666956116565"},message:"akin na lang po #33 at #44"}],Ve=Object(Ie.a)((function(e){return{root:{display:"block",width:"100%",maxWidth:"36ch",backgroundColor:e.palette.background.paper},inline:{display:"inline"}}})),Ae=function(e){var t=e.id,n=e.from,r=e.message,o=e.created_time,i=e.onClick,s=Object(a.useCallback)((function(){i({id:t,from:n,message:r,created_time:o})}),[i,t,n,r,o]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(we.a,{alignItems:"flex-start",onClick:s},c.a.createElement(Se.a,{primary:n.name,secondary:c.a.createElement(c.a.Fragment,null,c.a.createElement(ge.a,{component:"span",variant:"subtitle2",className:"inline",color:"textPrimary"},r))})),c.a.createElement(Te.a,{component:"li"}))},Pe=function(e){var t=e.messages,n=e.className,a=e.onClick;return c.a.createElement("div",{className:"flex flex-column overflow-y-auto"},c.a.createElement(_e.a,{className:n},t.map((function(e){return c.a.createElement(Ae,Object.assign({key:e.id},e,{onClick:a}))}))))},Fe=[{path:"/messages",component:function(){var e=Object(a.useState)(!1),t=Object(xe.a)(e,2),n=(t[0],t[1]),r=Object(a.useState)(Ne),o=Object(xe.a)(r,2),i=o[0],s=o[1],l=Object(a.useState)([]),m=Object(xe.a)(l,2),f=m[0],p=m[1],d=Object(a.useState)(""),b=Object(xe.a)(d,2),g=b[0],j=b[1],v=Ve(),O=Object(a.useCallback)((function(e){j(e.target.value)}),[]),k=Object(a.useCallback)((function(e){p((function(t){return t.find((function(t){return t.id===e.id}))?t:[].concat(Object(u.a)(t),[e])}))}),[]),E=Object(a.useCallback)((function(e){p((function(t){return t.filter((function(t){return t.id!==e.id}))}))}),[]),h=Object(a.useMemo)((function(){return i.filter((function(e){var t=e.message;return!g.trim().length||t.includes(g)}))}),[i,g]);return Oe((function(){ne.subscribe((function(e){s((function(t){return[].concat(Object(u.a)(t.slice(-300)),[e])}))})),te.subscribe((function(e){return n(e)}))})),c.a.createElement(Le.a,{container:!0,spacing:1},c.a.createElement(Le.a,{item:!0,xs:4,className:"flex-col"},c.a.createElement(Ce.a,{label:"Filter Message",variant:"outlined",className:"w-full",value:g,onChange:O}),c.a.createElement(Pe,{className:v.root,messages:h,onClick:k})),c.a.createElement(Le.a,{item:!0,xs:4,className:"flex-col"},c.a.createElement(ge.a,{component:"span",variant:"h6",className:"text-center block",color:"textPrimary",style:{height:"56px"}},"Saved Messages"),c.a.createElement(Pe,{className:v.root,messages:f,onClick:E})))}},{path:"/videos",component:function(){var e=Object(i.d)(),t=Object(i.e)(W),n=Object(a.useCallback)((function(t){return e(Q(t))}),[e]);return c.a.createElement("ul",null,t.map((function(e){return c.a.createElement(ye,Object.assign({key:e.id},e,{onClick:n}))})))}},{path:"/pages",component:function(){var e=Object(i.d)(),t=Object(i.e)(H),n=Object(a.useCallback)((function(t){return e(D(t))}),[e]);return c.a.createElement("ul",null,t.map((function(e){return c.a.createElement(he,Object.assign({key:e.id},e,{onClick:n}))})))}},{exact:!0,path:"/",component:function(e){var t=Object(i.d)(),n=Object(a.useCallback)((function(e){var n=e.authResponse;if("connected"===e.status){var a=n.accessToken,c=n.userID;t(U({accessToken:a,userId:c}))}}),[t]),r=Object(a.useCallback)((function(){Ee.FB.login(n)}),[n]);return Oe((function(){Ee.FB.init({appId:N.fb.appId,autoLogAppEvents:!0,xfbml:!0,version:N.fb.version}),Ee.FB.getLoginStatus(n)})),c.a.createElement(ke.a,{variant:"contained",color:"primary",onClick:r},"Login to Facebook")}}],Be=function(){return c.a.createElement(c.a.Fragment,null,Fe.map((function(e){return c.a.createElement(ve.a,Object.assign({key:e.path},e))})))},Ze=Object(Ie.a)((function(e){return{root:{display:"flex",flexDirection:"column",padding:"5px",paddingTop:"10px"}}})),Me=c.a.createContext({}),Ue=function(){var e=Ze();return c.a.createElement("div",{className:e.root},c.a.createElement(Me.Provider,{value:{}},c.a.createElement(Be,null)))};n(158);o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(de,null,c.a.createElement(s.a,null,c.a.createElement(i.a,{store:ue},c.a.createElement(p.a,{history:oe},c.a.createElement(a.Suspense,{fallback:c.a.createElement(je,null)},c.a.createElement(Ue,null))))))),document.getElementById("root"))}},[[122,1,2]]]);
//# sourceMappingURL=main.c214faf1.chunk.js.map